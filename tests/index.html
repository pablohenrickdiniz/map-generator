<!doctype html>
<html lang="pt_BR">
<head>
    <meta charset="UTF-8">
    <title>Teste de gerador</title>
    <script type="text/javascript" src="../plugins/math-lib/src/Math.js"></script>
    <script type="text/javascript" src="../plugins/app-object/app-object.js"></script>
    <script type="text/javascript" src="../plugins/canvas-engine/src/CanvasLayer.js"></script>
    <script type="text/javascript" src="../plugins/keyboard-reader/src/keyboard-reader.js"></script>
    <script type="text/javascript" src="../plugins/mouse-reader/src/mouse-reader.js"></script>
    <script type="text/javascript" src="../plugins/canvas-engine/src/Color.js"></script>
    <script type="text/javascript" src="../plugins/canvas-engine/src/CanvasEngine.js"></script>
    <script type="text/javascript" src="../plugins/rpg-engine/src/RPGCanvas.js"></script>
    <script type="text/javascript" src="../plugins/jsSHA/src/sha1.js"></script>
    <script type="text/javascript" src="../plugins/quadtree/src/quad-tree.js"></script>
    <script type="text/javascript" src="../plugins/rpg-engine/src/Map.js"></script>
    <script type="text/javascript" src="../plugins/rpg-engine/src/ImageLoader.js"></script>
    <script type="text/javascript" src="../plugins/rpg-engine/src/Tileset.js"></script>
    <script type="text/javascript" src="../plugins/noisejs/perlin.js"></script>
    <script type="text/javascript" src="../src/map-generator.js"></script>
    <script type="text/javascript">
        const WATER_1 = '#000080';
        const WATER_2 = '#0000cc';
        const WATER_3 = '#3333ff';
        const WATER_4 = '#6666ff';
        const SAND = 'yellow';
        const GRASS = 'ForestGreen';
        const FOREST = 'green';
        const MOUNTAIN = '#cccccc';
        const SNOW = 'white';

        function init(){
            var container = document.getElementById('container');
            var engine = CE.create({
                container:container,
                width:3200,
                height:3200
            },RPGCanvas);

            var layer = engine.createLayer({
                width:3200,
                height:3200
            });
            var context = layer.getContext();

            MapGenerator.seed(0);
            MapGenerator.setPortion(WATER_1,0,0.1);
            MapGenerator.setPortion(WATER_2,0.1,0.15);
            MapGenerator.setPortion(WATER_3,0.15,0.2);
            MapGenerator.setPortion(WATER_4,0.2,0.3);
            MapGenerator.setPortion(SAND,0.3,0.35);
            MapGenerator.setPortion(GRASS,0.35,0.5);
            MapGenerator.setPortion(FOREST,0.5,0.8);
            MapGenerator.setPortion(MOUNTAIN,0.8,0.9);
            MapGenerator.setPortion(SNOW,0.9);
            var height_map = MapGenerator.generate2d(0,0,100,100);

            ImageLoader.loadAll(['tilesets/sea-&-beach.png','tilesets/snow.png','tilesets/Town & Village - 0034.png'],function(images){
                var map = new Map({
                    width:100,
                    height:100
                });

                var tileset_sea = new Tileset(images[0]);
                var tileset_snow = new Tileset(images[1]);
                var tileset_water = new Tileset(images[2]);

                var sand = tileset_sea.get(0,1);
                var grass = tileset_sea.get(0,0);
                var snow = tileset_snow.get(0,0);
                var water = tileset_water.get(4,4);

                sand.layer = 0;
                grass.layer = 0;
                snow.layer = 0;
                water.layer = 0;

                for(var i = 0; i < height_map.length;i++){
                    for(var j = 0; j < height_map[i].length;j++){
                        var portion = height_map[i][j];
                        switch(portion.type){
                            case WATER_1:
                            case WATER_2:
                            case WATER_3:
                            case WATER_4:
                                context.fillStyle = WATER_1;
                                map.setTile(i,j,water);
                                break;
                            case SAND:
                                map.setTile(i,j,sand);
                                break;
                            case FOREST:
                            case GRASS:
                                map.setTile(i,j,grass);
                                break;
                            case MOUNTAIN:
                            case SNOW:
                                map.setTile(i,j,snow);
                        }
                    }
                }
                RPGCanvas.drawMap(map,engine);
            });
        }

    </script>
</head>
<body onload="init()">
<div id="container">

</div>
</body>
</html>